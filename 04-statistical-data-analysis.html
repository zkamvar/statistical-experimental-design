<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Statistical Experimental Design: Statistics in Data Analysis</title><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" type="text/css" href="assets/styles.css"><script src="assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png"><link rel="manifest" href="site.webmanifest"><link rel="mask-icon" href="safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" content="#ffffff"></head><body>
    <header id="top" class="navbar navbar-expand-md navbar-light bg-white top-nav carpentries"><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-6">
      <div class="large-logo">
        <img alt="The Carpentries" src="assets/images/carpentries-logo.svg"><abbr class="badge badge-light" title="This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught." style="background-color: #FF4955; border-radius: 5px">
          <a href="https://cdh.carpentries.org/the-lesson-life-cycle.html#early-development-pre-alpha-through-alpha" class="external-link alert-link" style="color: #000">
            <i aria-hidden="true" class="icon" data-feather="alert-octagon" style="border-radius: 5px"></i>
            Pre-Alpha
          </a>
          <span class="visually-hidden">This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.</span>
        </abbr>
        
      </div>
    </div>
    <div class="selector-container">
      
      
      <div class="dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Learner View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li><button class="dropdown-item" type="button" onclick="window.location.href='instructor/04-statistical-data-analysis.html';">Instructor View</button></li>
        </ul></div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl navbar-light bg-white bottom-nav carpentries" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="The Carpentries" src="assets/images/carpentries-logo-sm.svg"></div>
    <div class="lesson-title-md">
      Statistical Experimental Design
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item">
          <span class="lesson-title">
            Statistical Experimental Design
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="reference.html#glossary">Glossary</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="profiles.html">Learner Profiles</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"><li><a class="dropdown-item" href="discuss.html">Discussion</a></li><li><a class="dropdown-item" href="reference.html">Glossary</a></li>
          </ul></li>
      </ul></div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a class="btn btn-primary" href="aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div><!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Statistical Experimental Design
</div>

<aside class="col-md-12 lesson-progress"><div style="width: NaN%" class="percentage">
    NaN%
  </div>
  <div class="progress carpentries">
    <div class="progress-bar carpentries" role="progressbar" style="width: NaN%" aria-valuenow="NaN" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Learner View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="instructor/04-statistical-data-analysis.html">Instructor View</a>
                      </div>
                    </div>
                  </div><!--/div.accordion-item-->
                </div><!--/div.accordion-flush-->
              </div><!--div.sidenav-view-selector -->
            </div><!--/div.col -->
      
            <hr></div><!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Setup</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="01-introduction.html">1. Introduction</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="02-experimental-structure.html">2. Essential Features of a Comparative Experiment</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="03-design-principles.html">3. Experimental Design Principles</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlushcurrent">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-headingcurrent">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapsecurrent" aria-expanded="true" aria-controls="flush-collapsecurrent">
        <span class="visually-hidden">Current Chapter</span>
        <span class="current-chapter">
        4. Statistics in Data Analysis
        </span>
      </button>
    </div><!--/div.accordion-header-->
        
    <div id="flush-collapsecurrent" class="accordion-collapse collapse show" aria-labelledby="flush-headingcurrent" data-bs-parent="#accordionFlushcurrent">
      <div class="accordion-body">
        <ul><li><a href="#a-picture-is-worth-a-thousand-words">A picture is worth a thousand words</a></li>
<li><a href="#the-first-step-in-data-analysis-plot-the-data">The first step in data analysis: plot the data!</a></li>
<li><a href="#random-variables">Random variables</a></li>
<li><a href="#the-null-hypothesis">The null hypothesis</a></li>
<li><a href="#the-alternative-hypothesis">The alternative hypothesis</a></li>
<li><a href="#probability-and-probability-distributions">Probability and probability distributions</a></li>
<li><a href="#statistical-significance-testing-the-t-test">Statistical significance testing: the t-test</a></li>
<li><a href="#the-perils-of-p-values">The perils of p-values</a></li>
<li><a href="#confidence-intervals">Confidence intervals</a></li>
<li><a href="#comparing-standard-deviations">Comparing standard deviations</a></li>
<li><a href="#sample-sizes-and-power-curves">Sample sizes and power curves</a></li>
        </ul></div><!--/div.accordion-body-->
    </div><!--/div.accordion-collapse-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="05-complete-random-design.html">5. Completely Randomized Designs</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="06-complete-random-design-multitreatment-factors.html">6. Completely Randomized Design with More than One Treatment Factor</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="07-complete-random-block.html">7. Randomized Complete Block Designs</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush9">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading9">
        <a href="08-repeated-measures-design.html">8. Repeated Measures Designs</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width"><div class="accordion accordion-flush resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul><li>
                        <a href="key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="reference.html#glossary">Glossary</a>
                      </li>
                      <li>
                        <a href="profiles.html">Learner Profiles</a>
                      </li>
                      <li><a href="discuss.html">Discussion</a></li><li><a href="reference.html">Glossary</a></li>
                    </ul></div>
                </div>
              </div>
            </div>
            <hr class="half-width resources"><a href="aio.html">See all in one page</a>
            

            <hr class="d-none d-sm-block d-md-none"><div class="d-grid gap-1">
            
            </div>
          </div><!-- /div.accordion -->
        </div><!-- /div.sidebar-inner -->
      </nav></div><!-- /div.sidebar -->
  </div><!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-instructor.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <nav class="lesson-content mx-md-4" aria-label="Previous and Next Chapter"><!-- content for small screens --><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="03-design-principles.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="05-complete-random-design.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="03-design-principles.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Experimental Design
        </a>
        <a class="chapter-link float-end" href="05-complete-random-design.html" rel="next">
          Next: Completely... 
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
      <hr></nav><main id="main-content" class="main-content"><div class="container lesson-content">
        <h1>Statistics in Data Analysis</h1>
        <p>Last updated on 2024-05-02 |
        
        <a href="https://github.com/smcclatchy/statistical-experimental-design/edit/main/episodes/04-statistical-data-analysis.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
        
        
        
        <div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>

        

<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul><li>How can information be extracted and communicated from experimental
data?</li>
</ul></div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul><li>Plotting reveals information in the data.</li>
<li>Statistical significance testing compares experimental data obtained
to probability distributions of data that might also be possible.</li>
<li>A probability distribution is a mathematical function that gives the
probabilities of different possible outcomes for an experiment.</li>
</ul></div>
</div>
</div>
</div>
</div>
<section id="a-picture-is-worth-a-thousand-words"><h2 class="section-heading">A picture is worth a thousand words<a class="anchor" aria-label="anchor" href="#a-picture-is-worth-a-thousand-words"></a>
</h2>
<hr class="half-width"><p>To motivate this next section on statistics, we start with an example
of human variability. This 1975 living histogram of women from the
University of Wisconsin Madison shows variability in a natural
population.</p>
<figure><img src="fig/joiner-living-histogram-heights.png" alt="living histogram of female student heights" class="figure mx-auto d-block"></figure><p><a href="https://personal.psu.edu/drh20/talks/joiner_living_histograms.pdf" class="external-link">B.
Joiner, Int’l Stats Review, 1975</a></p>
<div id="exercise-1-a-living-histogram" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-1-a-living-histogram" class="callout-inner">
<h3 class="callout-title">Exercise 1: A living histogram<a class="anchor" aria-label="anchor" href="#exercise-1-a-living-histogram"></a>
</h3>
<div class="callout-content">
<p>From the living histogram, can you estimate by eye<br>
1). the mean and median heights of this sample of women?<br>
2). the spread of the data? Estimate either standard deviation or
variance by eye. If you’re not sure how to do this, think about how you
would describe the spread of the data from the mean. You do not need to
calculate a statistic.<br>
3). any outliers? Estimate by eye - don’t worry about
calculations.<br>
4). What do you predict would happen to mean, median, spread and
outliers if an equal number of men were added to the histogram?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Solution to Exercise 1</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>1). Mean and median are two measures of the center of the data. The
median is the 50th% of the data with half the women above this value and
the other half below. There are approximately 100 students total. Fifty
of them appear to be above 5 feet 5 inches and fifty of them appear to
be below 5’5”. The median is not influenced by extreme values
(outliers), but the mean value is. While there are some very tall and
very short people, the bulk of them appear to be centered around a mean
of 5 foot 5 inches with a somewhat longer right tail to the histogram.
2). If the mean is approximately 5’5” and the distribution appears
normal (bell-shaped), then we know that approximately 68% of the data
lies within one standard deviation (sd) of the mean and ~95% lies within
two sd’s. If there are ~100 people in the sample, 95% of them lie
between 5’0” and 5’10” (2 sd’s = 5” above and 5” below the mean). One
standard deviation then would be about 5”/2 = 2.5” from the mean of
5’5”. So 68% of the data (~68 people) lie within 5 feet 2.5 inches and 5
feet 7.5 inches. 3). There are some very tall and very short people but
it’s not clear whether they are outliers. Outliers deviate significantly
from expected values, specifically by more than 3 standard deviations in
a normal distribution. Values that are greater than 3 sd’s (7.5”) above
or below the mean could be considered outliers. Outliers would then be
shorter than 4 feet 7.5 inches or taller than 6 feet 2.5 inches. The
shortest are 4 feet 9 inches and the tallest 6’ 0 inches. There are no
outliers in this sample because all heights fall within 3 sd’s. 4).
Average heights for men are greater than average heights for women, so
you could expect that a random sample of 100 men would increase the
average height of the sample of 200 students. The mean would shift to
the right of the distribution toward taller heights, as would the
median.</p>
</div>
</div>
</div>
</div>
</section><section id="the-first-step-in-data-analysis-plot-the-data"><h2 class="section-heading">The first step in data analysis: plot the data!<a class="anchor" aria-label="anchor" href="#the-first-step-in-data-analysis-plot-the-data"></a>
</h2>
<hr class="half-width"><p>A picture is worth a thousand words, and a picture of your data could
reveal important information that can guide you forward. So first, plot
the data!</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># read in the simulated heart rate data</span></span>
<span><span class="va">heart_rate</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span><span class="st">"data/heart_rate.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># take a random sample of 100 and create a histogram</span></span>
<span><span class="co"># first set the seed for the random number generator</span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">sample100</span> <span class="op">&lt;-</span> <span class="fu">sample</span><span class="op">(</span><span class="va">heart_rate</span><span class="op">$</span><span class="va">heart_rate</span>, <span class="fl">100</span><span class="op">)</span></span>
<span><span class="fu">hist</span><span class="op">(</span><span class="va">sample100</span>, xlab <span class="op">=</span> <span class="st">"resting heart rate for 100 participants"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/04-statistical-data-analysis-rendered-unnamed-chunk-3-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="exercise-2-what-does-this-picture-tell-you-about-resting-heart-rates" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-2-what-does-this-picture-tell-you-about-resting-heart-rates" class="callout-inner">
<h3 class="callout-title">Exercise 2: What does this picture tell you
about resting heart rates?<a class="anchor" aria-label="anchor" href="#exercise-2-what-does-this-picture-tell-you-about-resting-heart-rates"></a>
</h3>
<div class="callout-content">
<p>Do the data appear to be normally distributed? Why does this matter?
Do the left and right tails of the data seem to mirror each other or
not? Are there gaps in the data? Are there large clusters of similar
heart rate values in the data? Are there apparent outliers? What message
do the data deliver in this histogram?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">Solution to Exercise 2</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">

</div>
</div>
</div>
</div>
<p>Now create a boxplot of the same sample data.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">boxplot</span><span class="op">(</span><span class="va">sample100</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/04-statistical-data-analysis-rendered-unnamed-chunk-4-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="exercise-3-what-does-this-boxplot-tell-you-about-resting-heart-rates" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-3-what-does-this-boxplot-tell-you-about-resting-heart-rates" class="callout-inner">
<h3 class="callout-title">Exercise 3: What does this boxplot tell you
about resting heart rates?<a class="anchor" aria-label="anchor" href="#exercise-3-what-does-this-boxplot-tell-you-about-resting-heart-rates"></a>
</h3>
<div class="callout-content">
<p>What does the box signify? What does horizontal black line dividing
the box signify? Are there apparent outliers? How does the boxplot
relate to the histogram? What message do the data deliver in this
boxplot?</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">Solution to Exercise 3</h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">

</div>
</div>
</div>
</div>
<p>Plotting the data can identify unusual response measurements
(<strong>outliers</strong>), reveal relationships between variables, and
guide further statistical analysis. When data are not normally
distributed (bell-shaped and symmetrical), many of the statistical
methods typically used will not perform well. In these cases the data
can be transformed to a more symmetrical bell-shaped curve.</p>
</section><section id="random-variables"><h2 class="section-heading">Random variables<a class="anchor" aria-label="anchor" href="#random-variables"></a>
</h2>
<hr class="half-width"><p>The Generation 100 study aims to determine whether high-intensity
exercise in elderly adults affects lifespan and healthspan.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># heart_rate ~ exercise_group is a formula indicating that the response (heart</span></span>
<span><span class="co"># rate) is dependent on the treatment (exercise group)</span></span>
<span><span class="fu">boxplot</span><span class="op">(</span><span class="va">heart_rate</span> <span class="op">~</span> <span class="va">exercise_group</span>, data <span class="op">=</span> <span class="va">heart_rate</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/04-statistical-data-analysis-rendered-boxplot-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="exercise-4-comparing-two-groups---control-vs.-high-intensity" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-4-comparing-two-groups---control-vs.-high-intensity" class="callout-inner">
<h3 class="callout-title">Exercise 4: Comparing two groups - control
vs. high intensity<a class="anchor" aria-label="anchor" href="#exercise-4-comparing-two-groups---control-vs.-high-intensity"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal"><li>Does there appear to be a significant heart rate difference between
the control and high intensity exercise groups? How would you know?</li>
<li>Do any of the data overlap between the two boxplots?</li>
<li>Can you know which exercise group a person belongs to just by
knowing their heart rate? For example, for a heart rate of 80 could you
say with certainty that a person belongs to one group or the other?</li>
</ol></div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4">Solution to Exercise 4</h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" data-bs-parent="#accordionSolution4" aria-labelledby="headingSolution4">
<div class="accordion-body">
<ol style="list-style-type: decimal"><li>There appears to be a trend of lower heart rate in the
high-intensity exercise group, however, we can’t say whether or not it
is significant without performing statistical tests.</li>
<li>There is considerable overlap between the two groups, which shows
that there is considerable variability in the data.</li>
<li>Someone with a heart rate of 80 could belong to any group. When
considering significance of heart rate differences between the two
groups we don’t look at individuals, rather, we look at averages between
the two groups.</li>
</ol></div>
</div>
</div>
</div>
<p>The boxplots above show a trend of lower heart rate in the
high-intensity exercise group and higher heart rate in the control
exercise group. There is inherent variability in heart rate in both
groups however, which is to be expected. That variability appears in the
box and whisker lengths of the boxplots, along with any outliers that
appear as hollow circles outside of the whisker length. This variability
in heart rate measurements also means that the boxplots overlap between
the two groups, making it difficult to determine whether there is a
significant difference in mean heart rate between the groups.</p>
<p>We can calculate the difference in means between the two groups to
answer the question about exercise intensity.</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate the means of the two groups</span></span>
<span><span class="co"># load the tidyverse library to write more easily interpreted code</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span>
<span></span>
<span><span class="va">HI</span> <span class="op">&lt;-</span> <span class="va">heart_rate</span> <span class="op">%&gt;%</span> <span class="fu">filter</span><span class="op">(</span><span class="va">exercise_group</span> <span class="op">==</span> <span class="st">"high intensity"</span><span class="op">)</span></span>
<span><span class="va">control</span> <span class="op">&lt;-</span> <span class="va">heart_rate</span> <span class="op">%&gt;%</span> <span class="fu">filter</span><span class="op">(</span><span class="va">exercise_group</span> <span class="op">==</span> <span class="st">"control"</span><span class="op">)</span></span>
<span><span class="va">meanDiff</span> <span class="op">&lt;-</span> <span class="fu">mean</span><span class="op">(</span><span class="va">control</span><span class="op">$</span><span class="va">heart_rate</span><span class="op">)</span> <span class="op">-</span> <span class="fu">mean</span><span class="op">(</span><span class="va">HI</span><span class="op">$</span><span class="va">heart_rate</span><span class="op">)</span></span></code></pre>
</div>
<p>The actual difference in mean heart rates between the two groups is
2.21. Another way of stating this is that the high-intensity group had a
mean heart rate that was 3 percent lower than the control group. This is
the <em>observed effect size</em>.</p>
<p>So are we done now? Does this difference support the alternative
hypothesis that there is a significant difference in mean heart rates?
Or does it fail to reject the null hypothesis of no significant
difference? Why do we need p-values and confidence intervals if we have
evidence we think supports our claim? The reason is that the mean values
are <strong>random variables</strong> that can take many different
values. We are working with two samples of elderly Norwegians, not the
entire population of elderly Norwegians. The means are
<strong>estimates</strong> of the true mean heart rate of the entire
population, a number that we can never know because we can’t access the
entire population of elders. The sample means will vary with every
sample we take from the population. To demonstrate this, let’s take a
sample from each exercise group and calculate the difference in means
for those samples.</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate the sample mean of 100 people in each group</span></span>
<span><span class="va">HI100</span> <span class="op">&lt;-</span> <span class="fu">mean</span><span class="op">(</span><span class="fu">sample</span><span class="op">(</span><span class="va">HI</span><span class="op">$</span><span class="va">heart_rate</span>, size <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">control100</span> <span class="op">&lt;-</span> <span class="fu">mean</span><span class="op">(</span><span class="fu">sample</span><span class="op">(</span><span class="va">control</span><span class="op">$</span><span class="va">heart_rate</span>, size <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">control100</span> <span class="op">-</span> <span class="va">HI100</span> </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1.556033</code></pre>
</div>
<p>Now take another sample of 100 from each group and calculate the
difference in means.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate the sample mean of 100 people in each group</span></span>
<span><span class="va">HI100</span> <span class="op">&lt;-</span> <span class="fu">mean</span><span class="op">(</span><span class="fu">sample</span><span class="op">(</span><span class="va">HI</span><span class="op">$</span><span class="va">heart_rate</span>, size <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">control100</span> <span class="op">&lt;-</span> <span class="fu">mean</span><span class="op">(</span><span class="fu">sample</span><span class="op">(</span><span class="va">control</span><span class="op">$</span><span class="va">heart_rate</span>, size <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">control100</span> <span class="op">-</span> <span class="va">HI100</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 2.303506</code></pre>
</div>
<p>Are the differences in sample means the same? We can repeat this
sampling again and again, and each time arrive at a different value. The
sample means are a random variable, meaning that they can take on any
number of different values. Since they are random variables, the
difference between the means (the <em>observed effect size</em>) is also
a random variable.</p>
<p>Supposing we did have access to the entire population of elderly
Norwegians. Can we determine the mean resting heart rate for the entire
population, rather than just for samples of the population? Imagine that
you have measured the resting heart rate of the entire population of
elders 70 or older, not just the 1,567 from the Generation 100 study. In
practice we would never have access to the entire population, so this is
a thought exercise.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># read in the heart rates of the entire population of all elderly people</span></span>
<span><span class="va">population</span> <span class="op">&lt;-</span> <span class="fu">rbind</span><span class="op">(</span><span class="va">HI</span>, <span class="va">control</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># sample 100 of them and calculate the mean three times</span></span>
<span><span class="fu">mean</span><span class="op">(</span><span class="fu">sample</span><span class="op">(</span><span class="va">population</span><span class="op">$</span><span class="va">heart_rate</span>, size <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 69.39432</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">mean</span><span class="op">(</span><span class="fu">sample</span><span class="op">(</span><span class="va">population</span><span class="op">$</span><span class="va">heart_rate</span>, size <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 70.69518</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">mean</span><span class="op">(</span><span class="fu">sample</span><span class="op">(</span><span class="va">population</span><span class="op">$</span><span class="va">heart_rate</span>, size <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 69.51392</code></pre>
</div>
<p>Notice how the mean changes each time you sample. We can continue to
do this many times to learn about the distribution of this random
variable. Comparing the data obtained to a <em>probability
distribution</em> of data that might have been obtained can help to
answer questions about the effects of exercise intensity on heart
rate.</p>
</section><section id="the-null-hypothesis"><h2 class="section-heading">The null hypothesis<a class="anchor" aria-label="anchor" href="#the-null-hypothesis"></a>
</h2>
<hr class="half-width"><p>Now let’s return to the mean difference between treatment groups. How
do we know that this difference is due to the exercise? What happens if
all do the same exercise intensity? Will we see a difference as large as
we saw between the two treatment groups? This is called the null
hypothesis. The word null reminds us to be skeptical and to entertain
the possibility that there is no difference.</p>
<p>Because we have access to the population, we can randomly sample 100
controls to observe as many of the differences in means when exercise
intensity has no effect. We can give everyone the same exercise plan and
then record the difference in means between two randomly split groups of
100 and 100.</p>
<p>Here is this process written in R code:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## 100 controls</span></span>
<span><span class="va">control</span> <span class="op">&lt;-</span> <span class="fu">sample</span><span class="op">(</span><span class="va">population</span><span class="op">$</span><span class="va">heart_rate</span>, <span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## another 100 controls that we pretend are on a high-intensity regimen</span></span>
<span><span class="va">treatment</span> <span class="op">&lt;-</span> <span class="fu">sample</span><span class="op">(</span><span class="va">population</span><span class="op">$</span><span class="va">heart_rate</span>, <span class="fl">100</span><span class="op">)</span></span>
<span><span class="fu">mean</span><span class="op">(</span><span class="va">control</span><span class="op">)</span> <span class="op">-</span> <span class="fu">mean</span><span class="op">(</span><span class="va">treatment</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1.041263</code></pre>
</div>
<p>Now let’s find the sample mean of 100 participants from each group
10,000 times.</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">treatment</span> <span class="op">&lt;-</span> <span class="fu">replicate</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10000</span>, <span class="fu">mean</span><span class="op">(</span><span class="fu">sample</span><span class="op">(</span><span class="va">population</span><span class="op">$</span><span class="va">heart_rate</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">control</span> <span class="op">&lt;-</span> <span class="fu">replicate</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10000</span>, <span class="fu">mean</span><span class="op">(</span><span class="fu">sample</span><span class="op">(</span><span class="va">population</span><span class="op">$</span><span class="va">heart_rate</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">null</span> <span class="op">&lt;-</span> <span class="va">control</span> <span class="op">-</span> <span class="va">treatment</span></span>
<span><span class="fu">hist</span><span class="op">(</span><span class="va">null</span><span class="op">)</span></span>
<span><span class="fu">abline</span><span class="op">(</span>v<span class="op">=</span><span class="va">meanDiff</span>, col<span class="op">=</span><span class="st">"red"</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/04-statistical-data-analysis-rendered-unnamed-chunk-10-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p><code>null</code> contains the differences in means between the two
groups sampled 10,000 times each. The value of the observed difference
in means between the two groups, <code>meanDiff</code>, is shown as a
vertical red line. The values in <code>null</code> make up the
<strong>null distribution</strong>. How many of these differences are
greater than the observed difference in means between the actual
treatment and control groups?</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">mean</span><span class="op">(</span><span class="va">null</span> <span class="op">&gt;=</span> <span class="va">meanDiff</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.0583</code></pre>
</div>
<p>Approximately 5.8% of the 10,000 simulations are greater than the
observed difference in means. We can expect then that we will see a
difference in means approximately 5.8% of the time even if there is no
effect of exercise on heart rate. This is known as a
<strong>p-value</strong>.</p>
<div id="exercise-5-what-does-a-p-value-mean" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-5-what-does-a-p-value-mean" class="callout-inner">
<h3 class="callout-title">Exercise 5: What does a p-value mean?<a class="anchor" aria-label="anchor" href="#exercise-5-what-does-a-p-value-mean"></a>
</h3>
<div class="callout-content">
<p>What does this p-value tell us about the difference in means between
the two groups? How can we interpret this value? What does it say about
the significance of the difference in mean values?</p>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5">Solution to Exercise 5</h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" data-bs-parent="#accordionSolution5" aria-labelledby="headingSolution5">
<div class="accordion-body">

</div>
</div>
</div>
</div>
<p>P-values are often misinterpreted as the probability that, in this
example, high-intensity and control exercise result in the same average
heart rate. However, “high-intensity and control exercise result in the
same average heart rate” is not a <strong>random variable</strong> like
the number of heads or tails in 10 flips of a coin. It’s a statement
that doesn’t have a <strong>probability distribution</strong>, so you
can’t make probability statements about it. The p-value summarizes the
comparison between our data and the data we might have obtained from a
probability distribution if there were no difference in mean heart
rates. Specifically, the p-value tells us how far out on the tail of
that distribution the data we got falls. The smaller the p-value, the
greater the disparity between the data we have and the data distribution
that might have been. To understand this better, we’ll explore
probability distributions next.</p>
</section><section id="the-alternative-hypothesis"><h2 class="section-heading">The alternative hypothesis<a class="anchor" aria-label="anchor" href="#the-alternative-hypothesis"></a>
</h2>
<hr class="half-width"><p>We assume that our observations are drawn from a null distribution
with mean <i>μ<sub>0</sub></i>, which in this case equals zero because
the null hypothesis states that there is no difference between the
treatment groups. We reject the null hypothesis for values that fall
within the region defined by <i>α</i>, they Type I error rate. If we
have a value that falls within this region, it is possible to falsely
reject the null hypothesis and to assume that there is a treatment
effect when in reality none exists. False positives (Type I errors) are
typically set at a low rate (0.05) in good experimental design so that
specificity (1 - <i>α</i>) remains high. Specificity describes the
likelihood of true negatives, or accepting the null hypothesis when it
is true and correctly assuming that no effect exists.</p>
<p><a href="fig/Null-hypothesis.png" alt="null hypothesis"></a></p>
<figure><img src="fig/Alternative-hypothesis.png" alt="alternative hypothesis" class="figure mx-auto d-block"></figure><p>The alternative hypothesis challenges the null by stating that an
effect exists and that the mean difference, <i>μ<sub>A</sub></i>, is
greater than zero. The difference between <i>μ<sub>0</sub></i> and
<i>μ<sub>A</sub></i> is known as the effect size, which is expressed in
units of standard deviation: <i>d</i> = <i>μ<sub>A</sub></i> -
<i>μ<sub>0</sub></i> / <i>σ</i>.</p>
</section><section id="probability-and-probability-distributions"><h2 class="section-heading">Probability and probability distributions<a class="anchor" aria-label="anchor" href="#probability-and-probability-distributions"></a>
</h2>
<hr class="half-width"><p>Suppose you have measured the resting heart rate of the entire
population of elderly Norwegians 70 or older, not just the 1,567 from
the Generation 100 study. Imagine you need to describe all of these
numbers to someone who has no idea what resting heart rate is. Imagine
that all the measurements from the entire population are contained in
<code>population</code>. We could list out all of the numbers for them
to see or take a sample and show them the sample of heart rates, but
this would be inefficient and wouldn’t provide much insight into the
data. A better approach is to define and visualize a
<strong>distribution</strong>. The simplest way to think of a
distribution is as a compact description of many numbers.</p>
<p>Histograms show us the proportion of values within an interval. Here
is a histogram showing all resting heart rates for the entire population
70 and older.</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">population</span> <span class="op">%&gt;%</span> <span class="fu">ggplot</span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span><span class="va">heart_rate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_histogram</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<p><img src="fig/04-statistical-data-analysis-rendered-population_hist-1.png" style="display: block; margin: auto;" class="figure">
Showing this plot is much more informative and easier to interpret than
a long table of numbers. With this histogram we can approximate the
number of individuals in any given interval. For example, there are
approximately 38 individuals (~2.4%) with a resting heart rate greater
than 90, and another 44 individuals (~2.8%) with a resting heart rate
below 50.</p>
<p>The histogram above approximates one that is very common in nature:
the bell curve, also known as the <strong>normal distribution</strong>
or Gaussian distribution.</p>
<figure><img src="fig/04-statistical-data-analysis-rendered-standard_normal_dist-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>The curve shown above is an example of a <strong>probability density
function</strong> that defines a normal distribution. The y-axis is the
<strong>probability density</strong>, and the total area under the curve
sums to 1.0 on the y-axis. The x-axis denotes a variable <em>z</em> that
by statistical convention has a standard normal distribution. If you
draw a random value from a normal distribution, the probability that the
value falls in a particular interval, say from <em>a</em> to <em>b</em>,
is given by the area under the curve between <em>a</em> and <em>b</em>.
When the histogram of a list of numbers approximates the normal
distribution, we can use a convenient mathematical formula to
approximate the proportion of values or outcomes in any given interval.
That formula is conveniently stored in the function
<code>pnorm</code></p>
<p>If the normal approximation holds for our list of data values, then
the mean and variance (spread) of the data can be used. For example,
when we noticed that ~ 5.8% of the values in the null distribution were
greater than <code>meanDiff</code>, the mean difference between control
and high-intensity groups. We can compute the proportion of values below
a value <code>x</code> with <code>pnorm(x, mu, sigma)</code> where
<code>mu</code> is the mean and <code>sigma</code> the standard
deviation (the square root of the variance).</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">1</span> <span class="op">-</span> <span class="fu">pnorm</span><span class="op">(</span><span class="va">meanDiff</span>, mean<span class="op">=</span><span class="fu">mean</span><span class="op">(</span><span class="va">null</span><span class="op">)</span>, sd<span class="op">=</span><span class="fu">sd</span><span class="op">(</span><span class="va">null</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.05742643</code></pre>
</div>
<p>A useful characteristic of this approximation is that we only need to
know <code>mu</code> and <code>sigma</code> to describe the entire
distribution. From this, we can compute the proportion of values in any
interval.</p>
<p>Real-world populations may be approximated by the mathematical ideal
of the normal distribution. Repeat the sampling we did earlier and
produce a new histogram of the sample.</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sample100</span> <span class="op">&lt;-</span> <span class="fu">sample</span><span class="op">(</span><span class="va">heart_rate</span><span class="op">$</span><span class="va">heart_rate</span>, <span class="fl">100</span><span class="op">)</span></span>
<span><span class="fu">hist</span><span class="op">(</span><span class="va">sample100</span>, xlab <span class="op">=</span> <span class="st">"resting heart rate for 100 participants"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/04-statistical-data-analysis-rendered-sample-of-100-participants-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="exercise-6-sampling-from-a-population" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-6-sampling-from-a-population" class="callout-inner">
<h3 class="callout-title">Exercise 6: Sampling from a population<a class="anchor" aria-label="anchor" href="#exercise-6-sampling-from-a-population"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal"><li>Does the sample appear to be normally distributed?<br></li>
<li>Can you estimate the mean resting heart rate by eye?<br></li>
<li>What is the sample mean using R (hint: use
<code>mean()</code>)?<br></li>
<li>Can you estimate the sample standard deviation by eye? Hint: if
normally distributed, 68% of the data will lie within one standard
deviation of the mean and 95% will lie within 2 standard
deviations.<br></li>
<li>What is the sample standard deviation using R (hint: use
<code>sd()</code>)?<br></li>
<li>Estimate the number of people with a resting heart rate between 60
and 70.<br></li>
<li>What message does the sample deliver about the population from which
it was drawn?</li>
</ol></div>
</div>
</div>
<div id="accordionSolution6" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution6" aria-expanded="false" aria-controls="collapseSolution6">
  <h4 class="accordion-header" id="headingSolution6">Solution to Exercise 6</h4>
</button>
<div id="collapseSolution6" class="accordion-collapse collapse" data-bs-parent="#accordionSolution6" aria-labelledby="headingSolution6">
<div class="accordion-body">

</div>
</div>
</div>
</div>
<p>If you have doubts about whether the sample follows a normal
distribution, a quantile-quantile (QQ) plot can make interpretation
easier.</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">qqnorm</span><span class="op">(</span><span class="va">sample100</span><span class="op">)</span></span>
<span><span class="fu">qqline</span><span class="op">(</span><span class="va">sample100</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/04-statistical-data-analysis-rendered-qq-plot-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>We can use qq-plots to confirm that a distribution is relatively
close to normally distributed. A qq-plot compares data on the y-axis
against a theoretical distribution on the x-axis. If the data points
fall on the identity line (diagonal line), then the data is close to the
theoretical distribution. The larger the sample, the more forgiving the
result is to the weakness of this normal approximation. For small sample
sizes, the t-distribution works well.</p>
</section><section id="statistical-significance-testing-the-t-test"><h2 class="section-heading">Statistical significance testing: the t-test<a class="anchor" aria-label="anchor" href="#statistical-significance-testing-the-t-test"></a>
</h2>
<hr class="half-width"><p>Significance testing can answer questions about differences between
the two groups in light of inherent variability in heart rate
measurements. What does it mean that a difference is statistically
significant? We can eye plots like the boxplots above and see a
difference, however, we need something more objective than eyeballs to
claim a significant difference. A t-test will report whether the
difference in mean values between the two groups is significant. The
<strong>null hypothesis</strong> would state that there is no difference
in mean values, while the <strong>alternative hypothesis</strong> states
that there is a difference in the means of the two
<strong>samples</strong> from the whole <strong>population</strong> of
elders in Norway.</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># provide a formula stating that heart rate is dependent on exercise intensity</span></span>
<span><span class="fu">t.test</span><span class="op">(</span>formula <span class="op">=</span> <span class="va">heart_rate</span> <span class="op">~</span> <span class="va">exercise_group</span>, data <span class="op">=</span> <span class="va">population</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Welch Two Sample t-test

data:  heart_rate by exercise_group
t = 4.3418, df = 1563.5, p-value = 1.504e-05
alternative hypothesis: true difference in means between group control and group high intensity is not equal to 0
95 percent confidence interval:
 1.210325 3.205063
sample estimates:
       mean in group control mean in group high intensity 
                    70.99996                     68.79227 </code></pre>
</div>
</section><section id="the-perils-of-p-values"><h2 class="section-heading">The perils of p-values<a class="anchor" aria-label="anchor" href="#the-perils-of-p-values"></a>
</h2>
<hr class="half-width"><p>You can access the p-value alone from the t-test by saving the
results and accessing individual elements with the <code>$</code>
operator.</p>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># save the t-test result and access the p-value alone</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">t.test</span><span class="op">(</span>formula <span class="op">=</span> <span class="va">heart_rate</span> <span class="op">~</span> <span class="va">exercise_group</span>, data <span class="op">=</span> <span class="va">population</span><span class="op">)</span></span>
<span><span class="va">result</span><span class="op">$</span><span class="va">p.value</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1.504139e-05</code></pre>
</div>
<p>The p-value indicates a statistically significant difference between
exercise groups. It is not enough, though, to report only a p-value. The
p-value says nothing about the effect size (the observed difference). If
the effect size was tiny, say .01 or less, would it matter how small the
p-value is? The effect is negligible, so the p-value does nothing to
demonstrate practical relevance or meaning. We should question how large
the effect is. The p-value can only tell us whether an effect
exists.</p>
<p>A p-value can only tell us whether an effect exists. However, a
p-value greater than .05 doesn’t mean that no effect exists. The value
.05 is rather arbitrary. Does a p-value of .06 mean that there is no
effect? It does not. It would not provide evidence of an effect under
standard statistical protocol. Absence of evidence is not evidence of
absence. There could still be an effect.</p>
</section><section id="confidence-intervals"><h2 class="section-heading">Confidence intervals<a class="anchor" aria-label="anchor" href="#confidence-intervals"></a>
</h2>
<hr class="half-width"><p>P-values report statistical significance of an effect, but what we
want is scientific significance. Confidence intervals include estimates
of the effect size and uncertainty associated with these estimates. When
reporting results, use confidence intervals.</p>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># access the confidence interval</span></span>
<span><span class="va">result</span><span class="op">$</span><span class="va">conf.int</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1.210325 3.205063
attr(,"conf.level")
[1] 0.95</code></pre>
</div>
<p>The confidence interval states that the true difference in means is
between 1.21 and 3.21. We can say, with 95% confidence, that high
intensity exercise could decrease mean heart rate from 1.21 to 3.21
beats per minute. Note that these are simulated data and are not the
outcomes of the Generation 100 study.</p>
<p>A 95% confidence interval states that 95% of random intervals will
contain the true value. This is not the same as saying that there is a
95% chance that the true value falls within the interval. The graphic
below helps to explain a 95% confidence interval for the mean population
heart rate.</p>
<figure><img src="fig/04-statistical-data-analysis-rendered-confidence-interval-95-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>If we generate 200 confidence intervals for the mean population heart
rate, those confidence intervals will include the mean (vertical gray
dotted line) approximately 95% of the time. You will see that about 5%
of the confidence intervals (shown in red) fail to cover the mean.</p>
<div id="exercise-7-explaining-p-values-and-confidence-intervals" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-7-explaining-p-values-and-confidence-intervals" class="callout-inner">
<h3 class="callout-title">Exercise 7: Explaining p-values and confidence
intervals<a class="anchor" aria-label="anchor" href="#exercise-7-explaining-p-values-and-confidence-intervals"></a>
</h3>
<div class="callout-content">
<p>For each statement, explain to a partner why you believe the
statement is true or untrue.</p>
<ol style="list-style-type: decimal"><li>A p-value of .02 means that there is only a 2% chance that
high-intensity and control exercise result in the same average heart
rate.</li>
<li>A p-value of .02 demonstrates that there is a meaningful difference
in average heart rates between the two groups.</li>
<li>A 95% confidence interval has a 95% chance of containing the true
difference in means.</li>
<li>A confidence interval should be reported along with the
p-value.</li>
</ol></div>
</div>
</div>
<div id="accordionSolution7" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution7" aria-expanded="false" aria-controls="collapseSolution7">
  <h4 class="accordion-header" id="headingSolution7">Solution to Exercise 7</h4>
</button>
<div id="collapseSolution7" class="accordion-collapse collapse" data-bs-parent="#accordionSolution7" aria-labelledby="headingSolution7">
<div class="accordion-body">

</div>
</div>
</div>
</div>
</section><section id="comparing-standard-deviations"><h2 class="section-heading">Comparing standard deviations<a class="anchor" aria-label="anchor" href="#comparing-standard-deviations"></a>
</h2>
<hr class="half-width"><p>When comparing the means of data from the two groups, we need to ask
whether these data have equal variances (spreads). Previous studies and
prior knowledge can help us with this assumption. If we know from
previous data or from our own expertise that adjusting a treatment will
affect the mean response but not its variability, then we can assume
equal variances.</p>
<figure><img src="fig/04-statistical-data-analysis-rendered-compare-standard-deviation-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>However, if we suspect that changing a treatment will affect not only
mean response but also its variability, we will be as interested in
comparing standard deviations (the square root of the variance) as we
are in comparing means.</p>
<p><img src="fig/04-statistical-data-analysis-rendered-compare-means-standard-deviation-1.png" style="display: block; margin: auto;" class="figure">
As a rule of thumb, if the ratio of the larger variance to the smaller
variance is less than 4, the groups have equal variances.</p>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">heart_rate</span> <span class="op">%&gt;%</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">exercise_group</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise_at</span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="va">heart_rate</span><span class="op">)</span>, </span>
<span>               <span class="fu">list</span><span class="op">(</span>variance <span class="op">=</span> <span class="va">var</span>, standard_deviation <span class="op">=</span> <span class="va">sd</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 2 × 3
  exercise_group variance standard_deviation
  &lt;chr&gt;             &lt;dbl&gt;              &lt;dbl&gt;
1 control           103.               10.2 
2 high intensity     99.3               9.97</code></pre>
</div>
<p>A more formal approach uses an F test to compare variances between
samples drawn from a normal population.</p>
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">var.test</span><span class="op">(</span><span class="va">heart_rate</span> <span class="op">~</span> <span class="va">exercise_group</span>, data <span class="op">=</span> <span class="va">heart_rate</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	F test to compare two variances

data:  heart_rate by exercise_group
F = 1.0378, num df = 782, denom df = 782, p-value = 0.6041
alternative hypothesis: true ratio of variances is not equal to 1
95 percent confidence interval:
 0.901964 1.194081
sample estimates:
ratio of variances 
          1.037795 </code></pre>
</div>
<p>The F test reports that the variances between the groups are not the
same, however, the ratio of variances is very close to 1.</p>
</section><section id="sample-sizes-and-power-curves"><h2 class="section-heading">Sample sizes and power curves<a class="anchor" aria-label="anchor" href="#sample-sizes-and-power-curves"></a>
</h2>
<hr class="half-width"><p>Statistical power analysis is an important preliminary step in
experimental design. Sample size is an important component of
statistical power (the power to detect an effect). To get a better sense
of statistical power, let’s simulate a t-test for two groups with
different means and equal variances.</p>
<div class="codewrapper sourceCode" id="cb35">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">n_sims</span> <span class="op">&lt;-</span> <span class="fl">1000</span> <span class="co"># we want 1000 simulations</span></span>
<span><span class="va">p_vals</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="op">)</span>  <span class="co"># create a vector to hold the p-values</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n_sims</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">group1</span> <span class="op">&lt;-</span> <span class="fu">rnorm</span><span class="op">(</span>n<span class="op">=</span><span class="fl">30</span>, mean<span class="op">=</span><span class="fl">1</span>, sd<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="co"># simulate group 1</span></span>
<span>  <span class="va">group2</span> <span class="op">&lt;-</span> <span class="fu">rnorm</span><span class="op">(</span>n<span class="op">=</span><span class="fl">30</span>, mean<span class="op">=</span><span class="fl">0</span>, sd<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="co"># simulate group 2</span></span>
<span>  </span>
<span>  <span class="co"># run t-test and extract the p-value</span></span>
<span>  <span class="va">p_vals</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">t.test</span><span class="op">(</span><span class="va">group1</span>, <span class="va">group2</span>, var.equal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span> </span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">mean</span><span class="op">(</span><span class="va">p_vals</span> <span class="op">&lt;</span> <span class="fl">.05</span><span class="op">)</span> <span class="co"># check power (i.e. proportion of p-values that are smaller </span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.478</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb37">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span>                   <span class="co"># than alpha-level of .05)</span></span></code></pre>
</div>
<p>Let’s calculate the statistical power of our experiment so far, and
then determine the sample size we would need to run a similar experiment
on a different population.</p>
<div class="codewrapper sourceCode" id="cb38">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># sample size = 783 per group</span></span>
<span><span class="co"># delta = the observed effect size, meanDiff</span></span>
<span><span class="co"># sd = standard deviation </span></span>
<span><span class="co"># significance level (Type 1 error probability or </span></span>
<span><span class="co">#                     false positive rate) = 0.05</span></span>
<span><span class="co"># type = two-sample t-test</span></span>
<span><span class="co"># What is the power of this experiment to detect </span></span>
<span><span class="co">#                     an effect of size meanDiff?</span></span>
<span><span class="fu">power.t.test</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">783</span>, delta <span class="op">=</span> <span class="va">meanDiff</span>, sd <span class="op">=</span> <span class="fu">sd</span><span class="op">(</span><span class="va">heart_rate</span><span class="op">$</span><span class="va">heart_rate</span><span class="op">)</span>, </span>
<span>             sig.level <span class="op">=</span> <span class="fl">0.05</span>, type <span class="op">=</span> <span class="st">"two.sample"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
     Two-sample t test power calculation 

              n = 783
          delta = 2.207694
             sd = 10.11813
      sig.level = 0.05
          power = 0.9907288
    alternative = two.sided

NOTE: n is number in *each* group</code></pre>
</div>
<p>In biomedical studies, statistical power of 80% (0.8) is an accepted
standard. If we were to repeat the experiment with a different
population of elders (e.g.  Icelandic elders), what is the minimum
sample size we would need for each exercise group?</p>
<div class="codewrapper sourceCode" id="cb40">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># delta = the observed effect size, meanDiff</span></span>
<span><span class="co"># sd = standard deviation</span></span>
<span><span class="co"># significance level (Type 1 error probability or false positive rate) = 0.05</span></span>
<span><span class="co"># type = two-sample t-test</span></span>
<span><span class="co"># What is the minimum sample size we would need at 80% power?</span></span>
<span><span class="fu">power.t.test</span><span class="op">(</span>delta <span class="op">=</span> <span class="va">meanDiff</span>, sd <span class="op">=</span> <span class="fu">sd</span><span class="op">(</span><span class="va">heart_rate</span><span class="op">$</span><span class="va">heart_rate</span><span class="op">)</span>, </span>
<span>             sig.level <span class="op">=</span> <span class="fl">0.05</span>, type <span class="op">=</span> <span class="st">"two.sample"</span>, power <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
     Two-sample t test power calculation 

              n = 330.6946
          delta = 2.207694
             sd = 10.11813
      sig.level = 0.05
          power = 0.8
    alternative = two.sided

NOTE: n is number in *each* group</code></pre>
</div>
<p>As a rule of thumb, Lehr’s equation streamlines calculation of sample
size assuming equal variances and sample sizes drawn from a normal
distribution. The effect size is standardized by dividing the difference
in group means by the standard deviation. <em>Cohen’s d</em> describes
standardized effect sizes from 0.01 (very small) to 2.0 (huge).</p>
<div class="codewrapper sourceCode" id="cb42">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># n = (16/delta squared), where delta is the standardized effect size</span></span>
<span><span class="co"># delta = effect size standardized as Cohen's d</span></span>
<span><span class="co">#     (difference in means)/(standard deviation)  </span></span>
<span><span class="va">standardizedEffectSize</span> <span class="op">&lt;-</span> <span class="va">meanDiff</span><span class="op">/</span><span class="fu">sd</span><span class="op">(</span><span class="va">heart_rate</span><span class="op">$</span><span class="va">heart_rate</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">16</span><span class="op">/</span><span class="va">standardizedEffectSize</span><span class="op">^</span><span class="fl">2</span></span>
<span><span class="va">n</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 336.08</code></pre>
</div>
<p>Often budget constraints determine sample size. Lehr’s equation can
be rearranged to determine the effect size that can be detected for a
given sample size.</p>
<div class="codewrapper sourceCode" id="cb44">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># difference in means = (4 * sd)/(square root of n)</span></span>
<span><span class="co"># n = 100, the number that I can afford</span></span>
<span><span class="va">SD</span> <span class="op">&lt;-</span> <span class="fu">sd</span><span class="op">(</span><span class="va">heart_rate</span><span class="op">$</span><span class="va">heart_rate</span><span class="op">)</span></span>
<span><span class="va">detectableDifferenceInMeans</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">4</span> <span class="op">*</span> <span class="va">SD</span><span class="op">)</span><span class="op">/</span><span class="fu">sqrt</span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">detectableDifferenceInMeans</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 4.047251</code></pre>
</div>
<p>Try increasing or decreasing the sample size (100) to see how the
detectable difference in mean changes. Note the relationship: for very
large effects, you can get away with smaller sample sizes. For small
effects, you need large sample sizes.</p>
<p>A power curve can show us statistical power based on sample size and
effect size. Review the following figures to explore the relationships
between effect size, sample size, and power. What is the relationship
between effect size and sample size? Between sample size and power? What
do you notice about effect size and power as you increase the sample
size?</p>
<p><img src="fig/04-statistical-data-analysis-rendered-power-curve-1-1.png" style="display: block; margin: auto;" class="figure"><img src="fig/04-statistical-data-analysis-rendered-power-curve-1-2.png" style="display: block; margin: auto;" class="figure"><img src="fig/04-statistical-data-analysis-rendered-power-curve-1-3.png" style="display: block; margin: auto;" class="figure">
Code adapted from <a href="https://cinnipatel.medium.com/power-curve-in-r-8a1e67fb2600" class="external-link">Power
Curve in R</a> by Cinni Patel.</p>
<p>Review the following figure to explore the relationships between
effect size, sample size, and power. What is the relationship between
effect size and sample size? Between sample size and power?</p>
<p><img src="fig/04-statistical-data-analysis-rendered-power-curve-2-1.png" style="display: block; margin: auto;" class="figure">
Code adapted from <a href="https://levibaguley.github.io/2020/06/22/how-to-create-power-curves-in-ggplot/" class="external-link">How
to Create Power Curves in ggplot</a> by Levi Baguley</p>
<p>Notice that to detect a standardized effect size of 0.5 at 80% power,
you would need a sample size of approximately 70. Larger effect sizes
require much smaller sample sizes. Very small effects such as .01 never
reach the 80% power threshold without enormous samples sizes in the
hundreds of thousands.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul><li>Plotting and significance testing describe patterns in the data and
quantify effects against random variation.</li>
</ul></div>
</div>
</div>
</section></div> <!-- / div.lesson-content -->
    </main><!-- / main#main-content.main-content --><nav class="bottom-pagination mx-md-4" aria-label="Previous and Next Chapter"><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="03-design-principles.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="05-complete-random-design.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="03-design-principles.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Experimental Design
        </a>
        <a class="chapter-link float-end" href="05-complete-random-design.html" rel="next">
          Next: Completely... 
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
    </nav></div> <!-- / div.primary-content.col-xs-12 -->
<!-- END:   inst/pkgdown/templates/content-instructor.html-->

      </div><!--/div.row-->
      		<footer class="row footer mx-md-3"><hr><div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>
        
        <a href="https://github.com/smcclatchy/statistical-experimental-design/edit/main/episodes/04-statistical-data-analysis.Rmd" class="external-link">Edit on GitHub</a>
        
	
        | <a href="https://github.com/smcclatchy/statistical-experimental-design/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/smcclatchy/statistical-experimental-design/" class="external-link">Source</a></p>
				<p><a href="https://github.com/smcclatchy/statistical-experimental-design/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:team@carpentries.org">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">
        
        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>
        
        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.4" class="external-link">sandpaper (0.16.4)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.5" class="external-link">pegboard (0.7.5)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.2" class="external-link">varnish (1.0.2)</a></p>
			</div>
		</footer></div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://smcclatchy.github.io/statistical-experimental-design/04-statistical-data-analysis.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "Statistics in Data Analysis",
  "creativeWorkStatus": "active",
  "url": "https://smcclatchy.github.io/statistical-experimental-design/04-statistical-data-analysis.html",
  "identifier": "https://smcclatchy.github.io/statistical-experimental-design/04-statistical-data-analysis.html",
  "dateCreated": "2023-04-03",
  "dateModified": "2024-05-02",
  "datePublished": "2024-05-02"
}

  </script><script>
		feather.replace();
	</script><!-- Matomo
    2022-11-07: we have gotten a notification that we have an overage for our
    tracking and I'm pretty sure this has to do with Workbench usage.
    Considering that I am not _currently_ using this tracking because I do not
    yet know how to access the data, I am turning this off for now.
  <script>
    var _paq = window._paq = window._paq || [];
    /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
    _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
    _paq.push(["setDomains", ["*.preview.carpentries.org","*.datacarpentry.github.io","*.datacarpentry.org","*.librarycarpentry.github.io","*.librarycarpentry.org","*.swcarpentry.github.io", "*.carpentries.github.io"]]);
    _paq.push(["setDoNotTrack", true]);
    _paq.push(["disableCookies"]);
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
          var u="https://carpentries.matomo.cloud/";
          _paq.push(['setTrackerUrl', u+'matomo.php']);
          _paq.push(['setSiteId', '1']);
          var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
          g.async=true; g.src='https://cdn.matomo.cloud/carpentries.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
        })();
  </script>
  End Matomo Code --></body></html><!-- END:   inst/pkgdown/templates/layout.html-->

